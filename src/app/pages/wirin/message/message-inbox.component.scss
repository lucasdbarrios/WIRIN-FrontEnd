
/* Estilos para el popup de mensajes - Optimizado con Tailwind */
    .message-popup-dialog .p-dialog-content {
      @apply p-0 rounded-lg overflow-hidden;
    }
    
    .message-popup-container {
      @apply flex flex-col h-full;
      background-color: var(--surface-card);
    }
    
    .message-popup-header {
      background-color: var(--surface-card);
      border-bottom: 1px solid var(--surface-border);
    }
    
    .message-icon-container {
      @apply w-10 h-10;
    }
    
    .sender-avatar {
      @apply w-9 h-9;
    }
    
    .message-text {
      @apply max-h-80 overflow-y-auto;
      background-color: var(--surface-ground);
      scrollbar-width: thin;
      scrollbar-color: var(--primary-color) var(--surface-ground);
    }
    
    /* Estilos para el di치logo de detalles del mensaje */
    .message-details-dialog .p-dialog-content {
      @apply max-w-[90vw] max-h-[80vh] overflow-auto p-0;
    }
    
    /* Estilos para la vista de correo electr칩nico */
    .email-view-container {
      @apply rounded-lg overflow-hidden;
      font-family: var(--font-family);
      background-color: var(--surface-card);
    }
    
    .email-header {
      @apply p-6 border-b;
      border-color: var(--surface-border);
      background-color: var(--surface-section);
    }
    
    .email-subject {
      @apply text-2xl font-bold mb-4;
      color: var(--text-color);
    }
    
    .email-meta {
      @apply flex flex-col gap-2;
    }
    
    .email-sender, .email-recipient, .email-date {
      @apply flex items-baseline;
    }
    
    .meta-label {
      @apply font-semibold w-16 flex-shrink-0;
      color: var(--text-color-secondary);
    }
    
    .meta-value {
      color: var(--text-color);
    }
    
    .email-content {
      @apply p-6 min-h-[150px] leading-relaxed whitespace-pre-wrap border-b;
      border-color: var(--surface-border);
    }
    
    .email-additional-info {
      @apply p-4 px-6;
      background-color: var(--surface-ground);
    }
    
    .email-status {
      @apply flex gap-2 mb-4;
    }
    
    .status-tag {
      @apply inline-block px-3 py-1 rounded-full text-sm font-semibold;
    }
    
    .status-tag.responded {
      background-color: var(--green-100);
      color: var(--green-700);
    }
    
    .status-tag.draft {
      background-color: var(--yellow-100);
      color: var(--yellow-700);
    }
    
    .email-attachment {
      @apply my-4 p-3 rounded-md border border-dashed flex items-center gap-2;
      background-color: var(--surface-card);
      border-color: var(--surface-border);
    }
    
    .attachment-label {
      @apply font-semibold flex items-center gap-1;
      color: var(--text-color-secondary);
    }
    
    .email-technical-info {
      @apply mt-4;
    }
    
    .email-technical-info details {
      @apply border rounded-md p-2;
      border-color: var(--surface-border);
      background-color: var(--surface-card);
    }
    
    .email-technical-info summary {
      @apply cursor-pointer p-2 font-semibold;
      color: var(--primary-color);
    }
    
    .technical-details {
      @apply p-3 text-sm rounded mt-2;
      background-color: var(--surface-ground);
    }
    
    .message-details pre {
      @apply font-mono p-4 rounded-md border;
      background-color: var(--surface-ground);
      border-color: var(--surface-border);
    }
    
    .message-text::-webkit-scrollbar {
      width: 8px;
    }
    
    .message-text::-webkit-scrollbar-track {
      background: var(--surface-ground);
      border-radius: 4px;
    }
    
    .message-text::-webkit-scrollbar-thumb {
      background-color: var(--primary-color);
      border-radius: 4px;
    }
    
    .message-attachment {
      @apply transition-all duration-200;
    }
    
    .message-attachment:hover {
      background-color: var(--surface-hover);
    }
    
    .reply-container {
      @apply max-h-48 overflow-y-auto;
    }
    
    .quick-reply-textarea {
      @apply min-h-24 resize-y transition-all duration-300 ease-in-out;
    }
    
    .quick-reply-textarea:focus {
      box-shadow: 0 0 0 2px var(--primary-color-transparent);
    }
    
    /* Estilos para la tabla de mensajes */
    :host ::ng-deep .p-datatable .p-datatable-tbody > tr {
      @apply cursor-pointer transition-all duration-200;
    }
    
    :host ::ng-deep .p-datatable .p-datatable-tbody > tr:hover {
      @apply -translate-y-0.5;
      background-color: var(--surface-hover);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
    }
    
    /* Estilos para el modal de conversaci칩n estilo WhatsApp */
    .conversation-container {
      background-color: #f0f2f5;
      scrollbar-width: thin;
      scrollbar-color: var(--primary-color) #f0f2f5;
    }
    
    .conversation-container::-webkit-scrollbar {
      width: 6px;
    }
    
    .conversation-container::-webkit-scrollbar-track {
      background: #f0f2f5;
      border-radius: 4px;
    }
    
    .conversation-container::-webkit-scrollbar-thumb {
      background-color: var(--primary-color);
      border-radius: 4px;
    }
    
    .message-bubble {
      @apply relative max-w-[70%] w-fit shadow-sm break-words;
    }
    
    .message-bubble.ml-auto {
      border-radius: 12px 0 12px 12px;
    }
    
    .message-bubble.mr-auto {
      border-radius: 0 12px 12px 12px;
    }
    
    .max-w-30rem {
      @apply max-w-[30rem];
    }
    
    /* Animaci칩n para el popup */
.p-dialog-enter {
  animation: fadeIn 0.2s, slideDown 0.3s;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideDown {
  from { transform: translateY(-20px); }
  to { transform: translateY(0); }
}

/* Estilos mejorados para el historial de mensajes responsive */
.conversation-modal {
  .p-dialog {
    @apply max-w-[95vw] max-h-[90vh] m-4;
  }

  .p-dialog-content {
    @apply p-0 flex flex-col h-[80vh] min-h-[500px];
  }
}

.conversation-header {
  @apply text-white px-6 py-4 rounded-t-lg flex items-center justify-between flex-shrink-0 shadow-lg;
  background: linear-gradient(135deg, var(--primary-color), var(--primary-color-dark));

  .conversation-title {
    @apply text-lg font-semibold m-0;
  }

  .conversation-count {
    @apply text-sm opacity-90;
  }

  .header-actions {
    @apply flex gap-2;

    .p-button {
      @apply text-white p-2 rounded-md transition-all duration-200;
      background: rgba(255, 255, 255, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.3);

      &:hover {
        @apply -translate-y-0.5;
        background: rgba(255, 255, 255, 0.3);
      }
    }
  }
}

.conversation-messages {
  @apply flex-1 overflow-y-auto p-4 relative;
  background: linear-gradient(to bottom, #f8f9fa, #e9ecef);

  &::-webkit-scrollbar {
    width: 8px;
  }

  &::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.05);
    border-radius: 4px;
  }

  &::-webkit-scrollbar-thumb {
    background: var(--primary-color);
    border-radius: 4px;
    opacity: 0.7;

    &:hover {
      opacity: 1;
    }
  }
}

.date-separator {
  @apply text-center my-6 mb-4 sticky top-0 z-10;

  .date-label {
    @apply px-4 py-2 rounded-full text-sm font-medium shadow-lg border;
    background: rgba(255, 255, 255, 0.95);
    color: var(--text-color-secondary);
    backdrop-filter: blur(10px);
    border-color: rgba(0, 0, 0, 0.05);
  }
}

.message-item {
  @apply mb-6;
  
  .message-bubble {
    @apply relative break-words transition-all duration-200 ease-in-out;
    
    &:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15) !important;
    }
    
    // Mejores bordes redondeados para burbujas
    &.bg-primary {
      border-radius: 20px 20px 5px 20px;
      background: linear-gradient(135deg, var(--primary-color), var(--primary-color-dark)) !important;
    }
    
    &.bg-white {
      border-radius: 20px 20px 20px 5px;
      background: white !important;
      border: 1px solid var(--surface-border);
    }
  }
}

.user-avatar {
  @apply w-12 h-12 rounded-full flex items-center justify-center font-semibold text-base flex-shrink-0 shadow-lg border-4 border-white transition-all duration-200 ease-in-out;
  
  &:hover {
    @apply scale-105 shadow-xl;
  }
  
  // Avatar para mensajes propios
  &.bg-primary {
    @apply text-white;
    background: linear-gradient(135deg, var(--primary-color), var(--primary-color-dark));
  }
  
  // Avatar para mensajes de otros
  &.bg-surface-200 {
    background: var(--surface-200);
    color: var(--primary-color);
  }
}

.message-content {
  @apply flex-1 max-w-[calc(100%-60px)];
}

.message-bubble {
  @apply px-4 py-3 shadow-lg transition-all duration-200 ease-in-out relative break-words;

  &:hover {
    @apply -translate-y-0.5 shadow-xl;
  }

  .message-text {
    @apply leading-snug m-0;
  }

  .message-attachment {
    @apply mt-2 p-2 rounded-lg flex items-center gap-2 cursor-pointer transition-all duration-200;
    background: rgba(0, 0, 0, 0.05);

    &:hover {
      background: rgba(0, 0, 0, 0.1);
    }

    i {
      color: var(--primary-color);
    }
  }
}

.message-info {
  @apply mt-1 flex items-center gap-2 text-xs;
  color: var(--text-color-secondary);

  .message-time {
    @apply font-medium;
  }

  .read-status {
    @apply font-semibold;
    color: var(--primary-color);
  }
}

.conversation-reply {
  @apply bg-white border-t px-6 py-4 flex-shrink-0;
  border-color: var(--surface-border);

  .reply-form {
    @apply flex gap-3 items-end;
  }

  .reply-input {
    @apply flex-1 min-h-10 max-h-32 resize-none rounded-full border px-4 py-3 font-inherit transition-all duration-200;
    border-color: var(--surface-border);

    &:focus {
      @apply outline-none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 2px rgba(var(--primary-color-rgb), 0.2);
    }

    &::placeholder {
      color: var(--text-color-secondary);
    }
  }

  .reply-actions {
    @apply flex gap-2;

    .p-button {
      @apply rounded-full w-10 h-10 p-0 flex items-center justify-center transition-all duration-200;

      &:hover {
        @apply -translate-y-0.5 shadow-lg;
      }

      &.p-button-success {
        background: var(--green-500);
        border-color: var(--green-500);
      }

      &.p-button-secondary {
        background: var(--surface-200);
        border-color: var(--surface-200);
        color: var(--text-color);
      }
    }
  }
}

.empty-conversation {
  @apply flex flex-col items-center justify-center h-full text-center p-8;
  color: var(--text-color-secondary);

  i {
    @apply text-5xl mb-4 opacity-50;
  }

  h3 {
    @apply m-0 mb-2 font-semibold;
  }

  p {
    @apply m-0 opacity-80;
  }
}

/* Responsive Design */
@media (max-width: 768px) {
  .conversation-modal {
    .p-dialog {
      @apply w-screen h-screen max-w-none max-h-none m-0 rounded-none !important;
    }

    .p-dialog-content {
      @apply h-screen rounded-none;
    }
  }

  .conversation-header {
    @apply rounded-none p-4;

    .conversation-title {
      @apply text-base;
    }

    .header-actions {
      .p-button {
        @apply p-1.5;
      }
    }
  }

  .message-item {
    @apply mb-4;
    
    .message-bubble {
      @apply max-w-[calc(100vw-140px)] px-4 py-3;
    }
  }

  .user-avatar {
    @apply w-9 h-9 text-sm border-2;
  }

  .conversation-reply {
    @apply px-4 py-3;

    .reply-input {
      font-size: 16px; /* Prevents zoom on iOS */
    }

    .reply-actions {
      .p-button {
        @apply w-9 h-9;
      }
    }
  }
}

@media (max-width: 480px) {
  .message-item {
    @apply mb-3;
    
    .message-bubble {
      @apply max-w-[calc(100vw-110px)] px-3 py-2.5 text-sm;
    }
  }

  .date-separator {
    @apply my-4 mb-2;

    .date-label {
      @apply px-3 py-1.5 text-xs;
    }
  }

  .user-avatar {
    @apply w-8 h-8 text-xs border-2;
  }

  .conversation-reply {
    .reply-actions {
      .p-button {
        @apply w-8 h-8;
      }
    }
  }
}